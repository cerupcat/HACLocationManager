<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="HACLocationManager : This class allows you to conveniently manage the tedious process backwards compatibility in location between iOS7 and iOS 8">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>HACLocationManager</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/litoarias/HACLocationManager">View on GitHub</a>

          <h1 id="project_title">HACLocationManager</h1>
          <h2 id="project_tagline">This class allows you to conveniently manage the tedious process backwards compatibility in location between iOS7 and iOS 8</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/litoarias/HACLocationManager/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/litoarias/HACLocationManager/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <p><img src="https://github.com/litoarias/HACLocationManager/blob/master/ExampleApp/github.png?raw=true" alt="Logo"></p>

<p>HACLocationManager is written in Objective-C, very easy to use and effective class.<br>
Requests are made using blocks. Its syntax is very comfortable and intuitive.
Use singleton design pattern and its compatibility is complete with iOS7 or higher.
This class is not for use as GPS, only for obtain user location in any moment and get geocoding and reverse geocoding.</p>

<h2>
<a id="requirements-and-dependencies" class="anchor" href="#requirements-and-dependencies" aria-hidden="true"><span class="octicon octicon-link"></span></a>Requirements and Dependencies</h2>

<ul>
<li>iOS &gt;= 7.0</li>
<li>ARC enabled</li>
<li>CoreLocation Framework</li>
</ul>

<h2>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Installation</h2>

<h4>
<a id="cocoapods" class="anchor" href="#cocoapods" aria-hidden="true"><span class="octicon octicon-link"></span></a>CocoaPods:</h4>

<pre><code>    pod 'HACLocationManager'
</code></pre>

<h4>
<a id="manual-install" class="anchor" href="#manual-install" aria-hidden="true"><span class="octicon octicon-link"></span></a>Manual install:</h4>

<ul>
<li>Copy <code>HACLocationManager.h</code> and <code>HACLocationManager.m</code> to your project</li>
<li>Manual install <a href="https://github.com/litoarias/HACLocationManager/#manual-install">HACLocationManager</a>
</li>
</ul>

<h2>
<a id="usage" class="anchor" href="#usage" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage</h2>

<h3>
<a id="requesting-permission-to-access-location-services" class="anchor" href="#requesting-permission-to-access-location-services" aria-hidden="true"><span class="octicon octicon-link"></span></a>Requesting Permission to Access Location Services</h3>

<h4>
<a id="ios-7" class="anchor" href="#ios-7" aria-hidden="true"><span class="octicon octicon-link"></span></a>iOS 7</h4>

<p>For iOS 7, it is recommended that you provide a description for how your app uses location services by setting a string for the key <a href="https://developer.apple.com/library/ios/documentation/General/Reference/InfoPlistKeyReference/Articles/CocoaKeys.html#//apple_ref/doc/uid/TP40009251-SW27"><code>NSLocationUsageDescription</code></a> in your app's <code>Info.plist</code> file.</p>

<h4>
<a id="ios-8" class="anchor" href="#ios-8" aria-hidden="true"><span class="octicon octicon-link"></span></a>iOS 8</h4>

<p>Since iOS 8 it is required to add <code>NSLocationWhenInUseUsageDescription</code> key to your <code>Info.plist</code> file. Value for this key will be a description of UIAlertView presented to user while asking for location  permission. See <a href="https://developer.apple.com/library/ios/documentation/corelocation/reference/CLLocationManager_Class/index.html#//apple_ref/occ/instm/CLLocationManager/requestWhenInUseAuthorization">Apple documentation</a> for more info.</p>

<p>Basically all you need to do is to add single entry in your <code>Info.plist</code> file. Add key <code>NSLocationWhenInUseUsageDescription</code>, and select type <code>String</code>. The value you enter for this entry will be shown as text in UIAlertView presented to user first time you try to determine his location.
In the end it should look similar to this:</p>

<p><img src="https://github.com/litoarias/HACLocationManager/blob/master/ExampleApp/Info_plist.png?raw=true" alt="plist"></p>

<h3>
<a id="request-permissions" class="anchor" href="#request-permissions" aria-hidden="true"><span class="octicon octicon-link"></span></a>Request permissions</h3>

<p>To request permissions location, when you want independently to any operation. This request must always be performed before applying any other. I recommend do it in your AppDelegate.</p>

<div class="highlight highlight-objective-c"><pre>[[HACLocationManager <span class="pl-c1">sharedInstance</span>]requestAuthorizationLocation];</pre></div>

<h5>
<a id="instance-class--set-time-out" class="anchor" href="#instance-class--set-time-out" aria-hidden="true"><span class="octicon octicon-link"></span></a>Instance class &amp; set time out</h5>

<p>You can configure time out for updates in request, for default it's 5 seconds</p>

<div class="highlight highlight-objective-c"><pre>HACLocationManager *locationManager = [HACLocationManager <span class="pl-c1">sharedInstance</span>];
locationManager.timeoutUpdating = <span class="pl-c1">6</span>;</pre></div>

<h3>
<a id="obtain-user-location" class="anchor" href="#obtain-user-location" aria-hidden="true"><span class="octicon octicon-link"></span></a>Obtain user location</h3>

<p>Is obtained by locating blocks, based on the location and updates the last location obtained. The first is optional, only if your application requires it.</p>

<h5>
<a id="request-get-location" class="anchor" href="#request-get-location" aria-hidden="true"><span class="octicon octicon-link"></span></a>Request get Location</h5>

<div class="highlight highlight-objective-c"><pre>[locationManager <span class="pl-c1">LocationQuery</span>];</pre></div>

<h5>
<a id="updates-location" class="anchor" href="#updates-location" aria-hidden="true"><span class="octicon octicon-link"></span></a>Updates Location</h5>

<div class="highlight highlight-objective-c"><pre>locationManager.locationUpdatedBlock = ^(CLLocation *location){
  <span class="pl-c1">NSLog</span>(<span class="pl-s"><span class="pl-pds">@"</span><span class="pl-c1">%@</span><span class="pl-pds">"</span></span>, location);
};</pre></div>

<h5>
<a id="end-updates-location" class="anchor" href="#end-updates-location" aria-hidden="true"><span class="octicon octicon-link"></span></a>End updates Location</h5>

<div class="highlight highlight-objective-c"><pre>locationManager.locationEndBlock = ^(CLLocation *location){
  <span class="pl-c1">NSLog</span>(<span class="pl-s"><span class="pl-pds">@"</span><span class="pl-c1">%@</span><span class="pl-pds">"</span></span>, location);
};</pre></div>

<h5>
<a id="failed-to-obtain-the-location" class="anchor" href="#failed-to-obtain-the-location" aria-hidden="true"><span class="octicon octicon-link"></span></a>Failed to obtain the Location</h5>

<div class="highlight highlight-objective-c"><pre>locationManager.locationErrorBlock = ^(<span class="pl-c1">NSError</span> *error){
  <span class="pl-c1">NSLog</span>(<span class="pl-s"><span class="pl-pds">@"</span><span class="pl-c1">%@</span><span class="pl-pds">"</span></span>, error);
};</pre></div>

<h3>
<a id="geocoding" class="anchor" href="#geocoding" aria-hidden="true"><span class="octicon octicon-link"></span></a>Geocoding</h3>

<h5>
<a id="request-geocoding-of-user-location" class="anchor" href="#request-geocoding-of-user-location" aria-hidden="true"><span class="octicon octicon-link"></span></a>Request Geocoding of User Location</h5>

<div class="highlight highlight-objective-c"><pre>[locationManager <span class="pl-c1">GeocodingQuery</span>];</pre></div>

<h5>
<a id="get-address-of-user" class="anchor" href="#get-address-of-user" aria-hidden="true"><span class="octicon octicon-link"></span></a>Get Address of User</h5>

<p>Can multiple placemarks are received, so an array is returned </p>

<div class="highlight highlight-objective-c"><pre>locationManager.geocodingBlock = ^(<span class="pl-c1">NSArray</span> *placemarks){

    CLPlacemark *placemark = (CLPlacemark *)placemarks[<span class="pl-c1">0</span>];

    <span class="pl-c1">NSLog</span>(<span class="pl-s"><span class="pl-pds">@"</span><span class="pl-c1">%@</span><span class="pl-pds">"</span></span>,[<span class="pl-c1">NSString</span> <span class="pl-c1">stringWithFormat:</span><span class="pl-s"><span class="pl-pds">@"</span><span class="pl-c1">%@</span> <span class="pl-c1">%@</span><span class="pl-cce">\n</span><span class="pl-c1">%@</span> <span class="pl-c1">%@</span><span class="pl-cce">\n</span><span class="pl-c1">%@</span><span class="pl-cce">\n</span><span class="pl-c1">%@</span><span class="pl-pds">"</span></span>,
       placemark.subThoroughfare ? placemark.subThoroughfare : <span class="pl-s"><span class="pl-pds">@"</span><span class="pl-pds">"</span></span>,
       placemark.thoroughfare ? placemark.thoroughfare : <span class="pl-s"><span class="pl-pds">@"</span><span class="pl-pds">"</span></span>,
       placemark.postalCode ? placemark.postalCode : <span class="pl-s"><span class="pl-pds">@"</span><span class="pl-pds">"</span></span>,
       placemark.locality ? placemark.locality : <span class="pl-s"><span class="pl-pds">@"</span><span class="pl-pds">"</span></span>,
       placemark.administrativeArea ? placemark.administrativeArea : <span class="pl-s"><span class="pl-pds">@"</span><span class="pl-pds">"</span></span>,
       placemark.country ? placemark.country : <span class="pl-s"><span class="pl-pds">@"</span><span class="pl-pds">"</span></span>]);
};</pre></div>

<h5>
<a id="failed-to-obtain-address" class="anchor" href="#failed-to-obtain-address" aria-hidden="true"><span class="octicon octicon-link"></span></a>Failed to obtain Address</h5>

<div class="highlight highlight-objective-c"><pre>locationManager.geocodingErrorBlock = ^(<span class="pl-c1">NSError</span> *error){
  <span class="pl-c1">NSLog</span>(<span class="pl-s"><span class="pl-pds">@"</span><span class="pl-c1">%@</span><span class="pl-pds">"</span></span>, error);
};</pre></div>

<h3>
<a id="reverse-geocoding" class="anchor" href="#reverse-geocoding" aria-hidden="true"><span class="octicon octicon-link"></span></a>Reverse Geocoding</h3>

<h5>
<a id="request-reverse-geocoding" class="anchor" href="#request-reverse-geocoding" aria-hidden="true"><span class="octicon octicon-link"></span></a>Request Reverse Geocoding</h5>

<div class="highlight highlight-objective-c"><pre>[locationManager <span class="pl-c1">ReverseGeocodingQueryWithText:</span><span class="pl-s"><span class="pl-pds">@"</span>1755 Embarcadero Road Palo Alto, CA 94303<span class="pl-pds">"</span></span>];</pre></div>

<h5>
<a id="response" class="anchor" href="#response" aria-hidden="true"><span class="octicon octicon-link"></span></a>Response</h5>

<p>Can multiple placemarks are received, so an array is returned </p>

<div class="highlight highlight-objective-c"><pre>locationManager.reverseGeocodingBlock = ^(<span class="pl-c1">NSArray</span> *placemarks){
  <span class="pl-k">for</span> (<span class="pl-k">int</span> i = <span class="pl-c1">0</span>; i &lt; [placemarks <span class="pl-c1">count</span>]; i++){
     CLPlacemark * thisPlacemark = [placemarks <span class="pl-c1">objectAtIndex:</span>i];
     <span class="pl-c1">NSLog</span>(<span class="pl-s"><span class="pl-pds">@"</span><span class="pl-c1">%@</span><span class="pl-pds">"</span></span>, thisPlacemark);
  }
};</pre></div>

<h5>
<a id="failed-block" class="anchor" href="#failed-block" aria-hidden="true"><span class="octicon octicon-link"></span></a>Failed block</h5>

<div class="highlight highlight-objective-c"><pre>locationManager.reverseGeocodingErrorBlock = ^(<span class="pl-c1">NSError</span> *error){
  <span class="pl-c1">NSLog</span>(<span class="pl-s"><span class="pl-pds">"</span><span class="pl-ii">%</span>@<span class="pl-pds">"</span></span>, error);
};</pre></div>

<h3>
<a id="get-last-stored-location" class="anchor" href="#get-last-stored-location" aria-hidden="true"><span class="octicon octicon-link"></span></a>Get last stored location</h3>

<p>You can also get the latest location of the user stored persistently for those cases in which the location is not available.</p>

<div class="highlight highlight-objective-c"><pre><span class="pl-c1">NSLog</span>(<span class="pl-s"><span class="pl-pds">@"</span><span class="pl-c1">%@</span><span class="pl-pds">"</span></span>,locationManager.getLastSavedLocation);</pre></div>

<h3>
<a id="get-the-route-between-two-points" class="anchor" href="#get-the-route-between-two-points" aria-hidden="true"><span class="octicon octicon-link"></span></a>Get the route between two points.</h3>

<p>You can try changing the parameters in the sample project, changing the parameters of latitude and longitude.
The means of transport can also be chosen, walking or automovile, for default it's automovile.</p>

<div class="highlight highlight-objective-c"><pre>[[HACLocationManager <span class="pl-c1">sharedInstance</span>]RoutesBetweenTwoPointsWithUserLat:<span class="pl-c1">40.4376751</span>
                                                                    lngUser:-<span class="pl-c1">3.7044201</span>
                                                                    latDest:<span class="pl-c1">40.0619721</span>
                                                                    lngDest:-<span class="pl-c1">2.1480249</span>
                                                               transporType:automovile
                                                          onCompletionBlock:^(<span class="pl-c1">NSArray</span> * routes, <span class="pl-c1">NSError</span> *error){
        <span class="pl-k">if</span>(!error){

            [routes <span class="pl-c1">enumerateObjectsUsingBlock:</span>^(<span class="pl-k">id</span> obj, <span class="pl-k">NSUInteger</span> idx, <span class="pl-k">BOOL</span> *stop) {

                MKRoute *route = obj;

                MKPolyline *line = [route <span class="pl-c1">polyline</span>];

                [<span class="pl-v">self</span>.mapView <span class="pl-c1">addOverlay:</span>line];

                <span class="pl-c1">NSLog</span>(<span class="pl-s"><span class="pl-pds">@"</span>Rout Name : <span class="pl-c1">%@</span><span class="pl-pds">"</span></span>,route.<span class="pl-smi">name</span>);

                <span class="pl-c1">NSLog</span>(<span class="pl-s"><span class="pl-pds">@"</span>Total Distance (in Meters) :<span class="pl-c1">%f</span><span class="pl-pds">"</span></span>,route.<span class="pl-smi">distance</span>);

                <span class="pl-c1">NSArray</span> *steps = [route <span class="pl-c1">steps</span>];

                <span class="pl-c1">NSLog</span>(<span class="pl-s"><span class="pl-pds">@"</span>Total Steps : <span class="pl-c1">%lu</span><span class="pl-pds">"</span></span>,(<span class="pl-k">unsigned</span> <span class="pl-k">long</span>)[steps <span class="pl-c1">count</span>]);

                [steps <span class="pl-c1">enumerateObjectsUsingBlock:</span>^(<span class="pl-k">id</span> obj, <span class="pl-k">NSUInteger</span> idx, <span class="pl-k">BOOL</span> *stop) {

                    <span class="pl-c1">NSLog</span>(<span class="pl-s"><span class="pl-pds">@"</span>Rout Instruction : <span class="pl-c1">%@</span><span class="pl-pds">"</span></span>,[obj <span class="pl-c1">instructions</span>]);

                    <span class="pl-c1">NSLog</span>(<span class="pl-s"><span class="pl-pds">@"</span>Rout Distance : <span class="pl-c1">%f</span><span class="pl-pds">"</span></span>,[obj <span class="pl-c1">distance</span>]);

                }];
            }];
        }<span class="pl-k">else</span>{
            <span class="pl-c1">NSLog</span>(<span class="pl-s"><span class="pl-pds">@"</span><span class="pl-c1">%@</span><span class="pl-pds">"</span></span>, [error <span class="pl-c1">localizedDescription</span>]);
        }

    }];</pre></div>

<p>Enjoy :D</p>

<h2>
<a id="contributing" class="anchor" href="#contributing" aria-hidden="true"><span class="octicon octicon-link"></span></a>Contributing</h2>

<ol>
<li>Fork it ( <a href="https://github.com/%5Bmy-github-username%5D/HACLocationManager/fork">https://github.com/[my-github-username]/HACLocationManager/fork</a> )</li>
<li>Create your feature branch (<code>git checkout -b my-new-feature</code>)</li>
<li>Commit your changes (<code>git commit -am 'Add some feature'</code>)</li>
<li>Push to the branch (<code>git push origin my-new-feature</code>)</li>
<li>Create a new Pull Request</li>
</ol>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">HACLocationManager maintained by <a href="https://github.com/litoarias">litoarias</a></p>
        <p>Published with <a href="https://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-63853461-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>


  </body>
</html>
